<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notepad Modernizer - 90 Levels (Audited)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #444; }
        .bg-checkered {
            background-color: #ffffff;
            background-image: linear-gradient(45deg, #eee 25%, transparent 25%), linear-gradient(-45deg, #eee 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #eee 75%), linear-gradient(-45deg, transparent 75%, #eee 75%);
            background-size: 20px 20px;
        }
        /* CRT Effect for Terminal */
        .crt-text {
            text-shadow: 0 0 2px #22c55e;
        }
    </style>
</head>
<body class="bg-neutral-900 text-white h-screen overflow-hidden selection:bg-green-500 selection:text-black">
    <div id="root" class="h-full flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const Icon = ({ path, className = "" }) => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{path}</svg>;
        const TerminalIcon = () => <Icon path={<><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></>} />;
        const SaveIcon = () => <Icon path={<><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></>} />;
        const CheckCircleIcon = () => <Icon path={<><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></>} />;
        const PlayIcon = () => <Icon path={<polygon points="5 3 19 12 5 21 5 3"></polygon>} />;
        const GlobeIcon = () => <Icon path={<><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></>} />;

        // --- AUDITED LEVEL DATA (90 LEVELS) ---
        const LEVELS = [
            // ========================================
            // CHAPTER 1: BASIC STRUCTURE (1-12)
            // ========================================
            {
                id: 1, chapter: 1, type: 'choice',
                title: { en: '1. The Container', id: '1. Memilih Wadah (Container)' },
                desc: { en: 'Start modern. Choose the Div structure.', id: 'Mulai dengan modern. Pilih struktur Div.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Legacy Table', id: 'A. Table (Jadul)' }, previewCode: '<table width="100%">', code: '<table>...</table>', correct: false, msg: { en: 'Tables are for data, not layout!', id: 'Table hanya untuk data, bukan layout!' } },
                    { label: { en: 'B. Modern Div', id: 'B. Div Container' }, previewCode: '<div class="main">...</div>', code: '<div class="main-container">\n    <h1>Halo Dunia</h1>\n    <p>Selamat datang di web saya.</p>\n    \n    \n  </div>', cssToAdd: '\n    h1 { color: #333; text-align: left; /* <--- EDIT */ }\n    .main-container { max-width: 800px; margin: 0 auto; padding: 20px; }', correct: true, msg: { en: 'Div injected.', id: 'Div berhasil ditambahkan.' } }
                ]
            },
            {
                id: 2, chapter: 1, type: 'essay',
                title: { en: '2. Custom Header', id: '2. Kustomisasi Header' },
                desc: { en: 'Edit the H1 color and alignment.', id: 'Ubah warna dan posisi teks H1.' },
                guidance: { en: ['Change text-align to "center".', 'Change color to "blue" or "#2563eb".'], id: ['Ganti text-align jadi "center".', 'Ganti color jadi "blue" atau "#2563eb".'] },
                validation: (code) => /text-align:\s*center/i.test(code),
                successMsg: { en: 'Header centered!', id: 'Header di tengah!' }
            },
            {
                id: 3, chapter: 1, type: 'choice',
                title: { en: '3. Navigation Bar', id: '3. Navigasi' },
                desc: { en: 'Add a menu using Flexbox.', id: 'Tambah menu menggunakan Flexbox.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Vertical List', id: 'A. List Vertikal' }, previewCode: '<ul><li>...</li></ul>', code: '...', correct: false, msg: { en: 'We want a horizontal menu.', id: 'Kita mau menu horizontal.' } },
                    { label: { en: 'B. Flex Row', id: 'B. Flexbox (Horizontal)' }, previewCode: 'display: flex; gap: 20px;', code: '<nav class="menu-box">\n      <a href="#">Beranda</a>\n      <a href="#">Produk</a>\n      <a href="#">Kontak</a>\n    </nav>\n    ', cssToAdd: '\n    .menu-box { display: flex; gap: 20px; padding: 10px 0; border-bottom: 1px solid #ccc; /* <--- EDIT */ }\n    .menu-box a { text-decoration: none; color: #555; font-weight: bold; }', correct: true, msg: { en: 'Nav injected.', id: 'Navigasi ditambahkan.' } }
                ]
            },
            {
                id: 4, chapter: 1, type: 'essay',
                title: { en: '4. Style Links', id: '4. Edit Menu' },
                desc: { en: 'Space them out and change style.', id: 'Beri jarak dan ubah gaya.' },
                guidance: { en: ['Increase gap to 40px.', 'Change border-bottom color to #333.'], id: ['Perbesar gap jadi 40px.', 'Ubah warna border-bottom jadi #333.'] },
                validation: (code) => /gap:\s*(?!20px)/i.test(code),
                successMsg: { en: 'Links spaced!', id: 'Link berjarak!' }
            },
            {
                id: 5, chapter: 1, type: 'choice',
                title: { en: '5. Hero Section', id: '5. Hero Section (Banner)' },
                desc: { en: 'Add a big banner area.', id: 'Tambahkan area banner besar.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Text Only', id: 'A. Teks Saja' }, previewCode: '<p>Welcome</p>', code: '...', correct: false, msg: { en: 'Too boring.', id: 'Membosankan.' } },
                    { label: { en: 'B. Hero Banner', id: 'B. Hero Banner' }, previewCode: 'background-color: #eee;', code: '<div class="hero">\n      <h2>Welcome to Future</h2>\n      <p>Building the web, one div at a time.</p>\n    </div>\n    ', cssToAdd: '\n    .hero { \n      background-color: #f3f4f6; /* <--- GANTI BG */\n      padding: 60px 20px; \n      text-align: center; \n      border-radius: 10px; \n      margin-top: 20px; \n    }\n    .hero h2 { font-size: 2em; margin-bottom: 10px; }', correct: true, msg: { en: 'Hero injected.', id: 'Banner Hero ditambahkan.' } }
                ]
            },
            {
                id: 6, chapter: 1, type: 'essay',
                title: { en: '6. Customize Hero', id: '6. Kustomisasi Banner' },
                desc: { en: 'Make the banner pop!', id: 'Buat banner menonjol!' },
                guidance: { en: ['Change background-color to #e0e7ff.', 'Increase padding to 100px.'], id: ['Ganti background-color jadi #e0e7ff.', 'Ubah padding jadi 100px.'] },
                validation: (code) => /padding:\s*(?!60px)/i.test(code),
                successMsg: { en: 'Hero looks big!', id: 'Banner terlihat megah!' }
            },
            {
                id: 7, chapter: 1, type: 'choice',
                title: { en: '7. Content Grid', id: '7. Grid Konten' },
                desc: { en: 'Choose structure for articles.', id: 'Pilih struktur artikel.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Float Layout', id: 'A. Layout Float' }, previewCode: 'float: left;', code: '...', correct: false, msg: { en: 'Floats are obsolete.', id: 'Float sudah usang.' } },
                    { label: { en: 'B. CSS Grid', id: 'B. CSS Grid' }, previewCode: 'display: grid;', code: '<div class="grid-box">\n      <div class="card">Fitur A</div>\n      <div class="card">Fitur B</div>\n      <div class="card">Fitur C</div>\n    </div>\n    ', cssToAdd: '\n    .grid-box { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 30px; /* <--- EDIT KOLOM */ }\n    .card { background: white; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }', correct: true, msg: { en: 'Grid added.', id: 'Grid ditambahkan.' } }
                ]
            },
            {
                id: 8, chapter: 1, type: 'essay',
                title: { en: '8. Card Styling', id: '8. Kustomisasi Kartu' },
                desc: { en: 'Style the cards.', id: 'Hias kartu konten.' },
                guidance: { en: ['Add "box-shadow: 0 4px 8px rgba(0,0,0,0.1)" to .card.', 'Change background color to #fafafa.'], id: ['Tambahkan "box-shadow: 0 4px 8px rgba(0,0,0,0.1)" ke .card.', 'Ganti background jadi #fafafa.'] },
                validation: (code) => /box-shadow:/i.test(code),
                successMsg: { en: 'Cards look modern!', id: 'Kartu terlihat modern!' }
            },
            {
                id: 9, chapter: 1, type: 'choice',
                title: { en: '9. Footer', id: '9. Footer' },
                desc: { en: 'Add the footer.', id: 'Tambahkan footer.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Semantic Footer', id: 'A. Footer Semantik' }, previewCode: '<footer>...</footer>', code: '<footer class="site-footer">\n      &copy; 2024 Website Buatanku.\n    </footer>', cssToAdd: '\n    .site-footer { margin-top: 50px; padding: 20px; text-align: center; color: #888; border-top: 1px solid #eee; }', correct: true, msg: { en: 'Footer added.', id: 'Footer ditambahkan.' } },
                    { label: { en: 'B. Just text', id: 'B. Teks biasa' }, previewCode: '<p>End</p>', code: '...', correct: false, msg: { en: 'Use standard tags.', id: 'Gunakan tag standar.' } }
                ]
            },
            {
                id: 10, chapter: 1, type: 'essay',
                title: { en: '10. Footer Polish', id: '10. Sentuhan Footer' },
                desc: { en: 'Customize the footer.', id: 'Personalisasi footer.' },
                guidance: { en: ['Change text-align to "right".', 'Change color to #555.'], id: ['Ganti text-align jadi "right".', 'Ganti color jadi #555.'] },
                validation: (code) => /text-align:\s*right/i.test(code),
                successMsg: { en: 'Footer aligned!', id: 'Footer rata kanan!' }
            },
            {
                id: 11, chapter: 1, type: 'essay',
                title: { en: '11. Global Fonts', id: '11. Font Global' },
                desc: { en: 'Change font of the body.', id: 'Ubah font body.' },
                guidance: { en: ['Add font-family: "Verdana", sans-serif; to body.', 'Add line-height: 1.6;'], id: ['Tambah font-family: "Verdana", sans-serif; ke body.', 'Tambah line-height: 1.6;'] },
                validation: (code) => /font-family:/i.test(code),
                successMsg: { en: 'Typography set!', id: 'Tipografi diatur!' }
            },
            {
                id: 12, chapter: 1, type: 'essay',
                title: { en: '12. Review', id: '12. Review' },
                desc: { en: 'Check everything.', id: 'Cek semuanya.' },
                guidance: { en: ['Ensure no visual bugs.', 'Click Save Changes to finish chapter.'], id: ['Pastikan tidak ada bug visual.', 'Klik Simpan untuk selesaikan bab.'] },
                validation: (code) => true,
                successMsg: { en: 'Chapter 1 Done!', id: 'Bab 1 Selesai!' }
            },

            // ========================================
            // CHAPTER 2: FORMS & INPUT (13-25)
            // ========================================
            {
                id: 13, chapter: 2, type: 'choice',
                title: { en: '13. Contact Section', id: '13. Bagian Kontak' },
                desc: { en: 'Inject a form container.', id: 'Suntikkan wadah form.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Form Block', id: 'A. Blok Form' }, previewCode: '<form>...</form>', code: '<section class="contact-section">\n      <h2>Contact Us</h2>\n      <form class="contact-form">\n        \n      </form>\n    </section>\n    ', cssToAdd: '\n    .contact-section { margin-top: 40px; }\n    .contact-form { max-width: 400px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; }', correct: true, msg: { en: 'Form block added.', id: 'Blok form ditambahkan.' } }
                ]
            },
            {
                id: 14, chapter: 2, type: 'choice',
                title: { en: '14. Input Fields', id: '14. Input Field' },
                desc: { en: 'Add name and email.', id: 'Tambah nama dan email.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Inputs with Labels', id: 'A. Input dengan Label' }, previewCode: '<label>...</label><input>', code: '<div class="field">\n          <label>Name</label>\n          <input type="text" class="inp" placeholder="Your Name">\n        </div>\n        <div class="field">\n          <label>Email</label>\n          <input type="email" class="inp" placeholder="Your Email">\n        </div>\n        ', cssToAdd: '\n    .field { margin-bottom: 15px; }\n    .inp { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }', correct: true, msg: { en: 'Inputs added.', id: 'Input ditambahkan.' } }
                ]
            },
            {
                id: 15, chapter: 2, type: 'essay',
                title: { en: '15. Input Style', id: '15. Gaya Input' },
                desc: { en: 'Make inputs look better.', id: 'Buat input lebih bagus.' },
                guidance: { en: ['Change .inp padding to 12px.', 'Change border-radius to 6px.'], id: ['Ubah padding .inp jadi 12px.', 'Ubah border-radius jadi 6px.'] },
                validation: (code) => /padding:\s*12px/i.test(code),
                successMsg: { en: 'Inputs optimized.', id: 'Input dioptimalkan.' }
            },
            {
                id: 16, chapter: 2, type: 'choice',
                title: { en: '16. Action Button', id: '16. Tombol Aksi' },
                desc: { en: 'Add submit button.', id: 'Tambah tombol kirim.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Button Tag', id: 'A. Tag Button' }, previewCode: '<button>...</button>', code: '<button type="submit" class="btn">Send Message</button>', cssToAdd: '\n    .btn { background: #333; color: white; border: none; padding: 10px 20px; cursor: pointer; width: 100%; }', correct: true, msg: { en: 'Button added.', id: 'Tombol ditambahkan.' } }
                ]
            },
            {
                id: 17, chapter: 2, type: 'essay',
                title: { en: '17. Button Color', id: '17. Warna Tombol' },
                desc: { en: 'Make the button stand out.', id: 'Buat tombol mencolok.' },
                guidance: { en: ['Change .btn background to #2563eb (blue).', 'Add font-weight: bold;'], id: ['Ubah background .btn jadi #2563eb (biru).', 'Tambah font-weight: bold;'] },
                validation: (code) => /background:\s*#2563eb/i.test(code),
                successMsg: { en: 'Button popped!', id: 'Tombol menonjol!' }
            },
            {
                id: 18, chapter: 2, type: 'essay',
                title: { en: '18. Form Shadow', id: '18. Shadow Form' },
                desc: { en: 'Add depth to the form.', id: 'Beri kedalaman pada form.' },
                guidance: { en: ['Add box-shadow: 0 5px 15px rgba(0,0,0,0.1); to .contact-form.', 'Remove border if you want.'], id: ['Tambah box-shadow: 0 5px 15px rgba(0,0,0,0.1); ke .contact-form.', 'Hapus border jika mau.'] },
                validation: (code) => /box-shadow:/i.test(code),
                successMsg: { en: 'Form has depth.', id: 'Form punya kedalaman.' }
            },
            {
                id: 19, chapter: 2, type: 'essay',
                title: { en: '19. Label Weight', id: '19. Ketebalan Label' },
                desc: { en: 'Make labels bold.', id: 'Tebalkan label.' },
                guidance: { en: ['Add to .field label: font-weight: bold;', 'Add display: block; margin-bottom: 5px;'], id: ['Tambah ke .field label: font-weight: bold;', 'Tambah display: block; margin-bottom: 5px;'] },
                validation: (code) => /font-weight:\s*bold/i.test(code),
                successMsg: { en: 'Labels bold!', id: 'Label tebal!' }
            },
            {
                id: 20, chapter: 2, type: 'choice',
                title: { en: '20. Textarea', id: '20. Textarea' },
                desc: { en: 'Add message box before button.', id: 'Tambah kotak pesan sebelum tombol.' },
                targetMarker: '<button type="submit"',
                options: [
                   { label: { en: 'A. Textarea', id: 'A. Textarea' }, previewCode: '<textarea>', code: '<div class="field"><label>Message</label><textarea class="inp" rows="4"></textarea></div>\n        <button type="submit"', cssToAdd: '', correct: true, msg: { en: 'Textarea inserted.', id: 'Textarea disisipkan.' } }
                ]
            },
            {
                id: 21, chapter: 2, type: 'essay',
                title: { en: '21. Textarea Resize', id: '21. Resize Textarea' },
                desc: { en: 'Prevent horizontal resize.', id: 'Cegah resize horizontal.' },
                guidance: { en: ['Add to textarea.inp: resize: vertical;', 'This prevents breaking layout.'], id: ['Tambah ke textarea.inp: resize: vertical;', 'Ini mencegah layout rusak.'] },
                validation: (code) => /resize:\s*vertical/i.test(code),
                successMsg: { en: 'Resize controlled.', id: 'Resize terkontrol.' }
            },
            {
                id: 22, chapter: 2, type: 'essay',
                title: { en: '22. Focus State', id: '22. Status Fokus' },
                desc: { en: 'Highlight input when clicked.', id: 'Highlight input saat diklik.' },
                guidance: { en: ['Add .inp:focus { border-color: #2563eb; outline: none; }'], id: ['Tambah .inp:focus { border-color: #2563eb; outline: none; }'] },
                validation: (code) => /\.inp:focus/i.test(code),
                successMsg: { en: 'Focus state active.', id: 'Status fokus aktif.' }
            },
            {
                id: 23, chapter: 2, type: 'essay',
                title: { en: '23. Button Hover', id: '23. Hover Tombol' },
                desc: { en: 'Change button on hover.', id: 'Ubah tombol saat hover.' },
                guidance: { en: ['Add .btn:hover { opacity: 0.9; }', 'Or change background color.'], id: ['Tambah .btn:hover { opacity: 0.9; }', 'Atau ubah warna background.'] },
                validation: (code) => /\.btn:hover/i.test(code),
                successMsg: { en: 'Hover added.', id: 'Hover ditambahkan.' }
            },
            {
                id: 24, chapter: 2, type: 'essay',
                title: { en: '24. Roundness', id: '24. Kebulatan' },
                desc: { en: 'Round the corners.', id: 'Bulatkan sudut.' },
                guidance: { en: ['Change .contact-form border-radius to 10px.', 'Change .btn border-radius to 6px.'], id: ['Ubah border-radius .contact-form jadi 10px.', 'Ubah border-radius .btn jadi 6px.'] },
                validation: (code) => /border-radius:\s*(?!4px)/i.test(code),
                successMsg: { en: 'Rounded!', id: 'Dibulatkan!' }
            },
            {
                id: 25, chapter: 2, type: 'essay',
                title: { en: '25. Check Form', id: '25. Cek Form' },
                desc: { en: 'Final check for Chapter 2.', id: 'Cek akhir Bab 2.' },
                guidance: { en: ['Looks good?', 'Save to proceed.'], id: ['Terlihat bagus?', 'Simpan untuk lanjut.'] },
                validation: (code) => true,
                successMsg: { en: 'Chapter 2 Done!', id: 'Bab 2 Selesai!' }
            },

            // ========================================
            // CHAPTER 3: CSS VARIABLES (26-40)
            // ========================================
            {
                id: 26, chapter: 3, type: 'choice',
                title: { en: '26. Variable Block', id: '26. Blok Variabel' },
                desc: { en: 'Initialize CSS Variables.', id: 'Inisialisasi CSS Variables.' },
                targetMarker: '/* === AREA CSS KAMU ADA DI BAWAH === */',
                options: [
                    { label: { en: 'A. Root Block', id: 'A. Blok Root' }, previewCode: ':root { --main: blue; }', code: ':root {\n      --primary: #2563eb;\n      --bg-color: #ffffff;\n      --text-color: #333333;\n      --card-bg: #ffffff;\n    }\n    /* === AREA CSS KAMU ADA DI BAWAH === */', cssToAdd: '', correct: true, msg: { en: 'Variables declared.', id: 'Variabel dideklarasikan.' } }
                ]
            },
            {
                id: 27, chapter: 3, type: 'essay',
                title: { en: '27. Apply Primary', id: '27. Terapkan Primary' },
                desc: { en: 'Use --primary on button.', id: 'Gunakan --primary pada tombol.' },
                guidance: { en: ['Replace background color in .btn with var(--primary).'], id: ['Ganti warna background di .btn dengan var(--primary).'] },
                validation: (code) => /var\(--primary\)/i.test(code),
                successMsg: { en: 'Variable used.', id: 'Variabel digunakan.' }
            },
            {
                id: 28, chapter: 3, type: 'essay',
                title: { en: '28. Apply Background', id: '28. Terapkan Background' },
                desc: { en: 'Use variables for body.', id: 'Gunakan variabel untuk body.' },
                guidance: { en: ['In body {}, set background-color: var(--bg-color);', 'Set color: var(--text-color);'], id: ['Di body {}, set background-color: var(--bg-color);', 'Set color: var(--text-color);'] },
                validation: (code) => /var\(--bg-color\)/i.test(code),
                successMsg: { en: 'Body themed.', id: 'Body bertema.' }
            },
            {
                id: 29, chapter: 3, type: 'essay',
                title: { en: '29. New Variable', id: '29. Variabel Baru' },
                desc: { en: 'Create a secondary color.', id: 'Buat warna sekunder.' },
                guidance: { en: ['Add --secondary: #64748b; to :root.'], id: ['Tambah --secondary: #64748b; ke :root.'] },
                validation: (code) => /--secondary:/i.test(code),
                successMsg: { en: 'Secondary added.', id: 'Secondary ditambahkan.' }
            },
            {
                id: 30, chapter: 3, type: 'essay',
                title: { en: '30. Use Secondary', id: '30. Gunakan Secondary' },
                desc: { en: 'Apply secondary to footer text.', id: 'Terapkan secondary ke teks footer.' },
                guidance: { en: ['In .site-footer, change color to var(--secondary).'], id: ['Di .site-footer, ubah color jadi var(--secondary).'] },
                validation: (code) => /var\(--secondary\)/i.test(code),
                successMsg: { en: 'Footer themed.', id: 'Footer bertema.' }
            },
            {
                id: 31, chapter: 3, type: 'choice',
                title: { en: '31. Dark Mode Block', id: '31. Blok Dark Mode' },
                desc: { en: 'Inject dark mode query.', id: 'Suntikkan query dark mode.' },
                targetMarker: '/* === AREA CSS KAMU ADA DI BAWAH === */',
                options: [
                    { label: { en: 'A. Media Prefers-Color', id: 'A. Media Prefers-Color' }, previewCode: '@media (prefers-color-scheme: dark)', code: '\n    @media (prefers-color-scheme: dark) {\n      :root {\n        --bg-color: #1a1a1a;\n        --text-color: #f3f4f6;\n        --card-bg: #2a2a2a;\n        --secondary: #94a3b8;\n      }\n    }', cssToAdd: '', correct: true, msg: { en: 'Dark mode logic added.', id: 'Logika dark mode ditambah.' } }
                ]
            },
            {
                id: 32, chapter: 3, type: 'essay',
                title: { en: '32. Card Theme', id: '32. Tema Kartu' },
                desc: { en: 'Ensure cards use variable.', id: 'Pastikan kartu pakai variabel.' },
                guidance: { en: ['Change .card background to var(--card-bg).', 'Change color to var(--text-color).'], id: ['Ubah background .card jadi var(--card-bg).', 'Ubah color jadi var(--text-color).'] },
                validation: (code) => /var\(--card-bg\)/i.test(code),
                successMsg: { en: 'Cards adaptive.', id: 'Kartu adaptif.' }
            },
            {
                id: 33, chapter: 3, type: 'essay',
                title: { en: '33. Form Theme', id: '33. Tema Form' },
                desc: { en: 'Fix form inputs for dark mode.', id: 'Perbaiki input form untuk dark mode.' },
                guidance: { en: ['In .inp, add background: var(--card-bg);', 'Add color: var(--text-color);'], id: ['Di .inp, tambah background: var(--card-bg);', 'Tambah color: var(--text-color);'] },
                validation: (code) => /\.inp[\s\S]*var\(--card-bg\)/i.test(code),
                successMsg: { en: 'Inputs adaptive.', id: 'Input adaptif.' }
            },
            {
                id: 34, chapter: 3, type: 'essay',
                title: { en: '34. Link Theme', id: '34. Tema Link' },
                desc: { en: 'Nav links need variables.', id: 'Link nav butuh variabel.' },
                guidance: { en: ['Change .menu-box a color to var(--text-color).'], id: ['Ubah color .menu-box a jadi var(--text-color).'] },
                validation: (code) => /menu-box[\s\S]*var\(--text-color\)/i.test(code),
                successMsg: { en: 'Nav adaptive.', id: 'Nav adaptif.' }
            },
            {
                id: 35, chapter: 3, type: 'essay',
                title: { en: '35. Radius Variable', id: '35. Variabel Radius' },
                desc: { en: 'Standardize corners.', id: 'Standarisasi sudut.' },
                guidance: { en: ['Add --radius: 8px; to :root.', 'Use var(--radius) in .card and .btn.'], id: ['Tambah --radius: 8px; ke :root.', 'Gunakan var(--radius) di .card dan .btn.'] },
                validation: (code) => /--radius:/i.test(code),
                successMsg: { en: 'Radius standardized.', id: 'Radius standar.' }
            },
            {
                id: 36, chapter: 3, type: 'essay',
                title: { en: '36. Spacing Variable', id: '36. Variabel Spacing' },
                desc: { en: 'Standardize gaps.', id: 'Standarisasi jarak.' },
                guidance: { en: ['Add --spacing: 20px; to :root.', 'Use var(--spacing) in .grid-box gap.'], id: ['Tambah --spacing: 20px; ke :root.', 'Gunakan var(--spacing) di gap .grid-box.'] },
                validation: (code) => /--spacing:/i.test(code),
                successMsg: { en: 'Spacing standardized.', id: 'Jarak standar.' }
            },
            {
                id: 37, chapter: 3, type: 'essay',
                title: { en: '37. Hero Dark Fix', id: '37. Fix Hero Dark' },
                desc: { en: 'Hero background is static. Fix it.', id: 'Background Hero statis. Perbaiki.' },
                guidance: { en: ['Create --hero-bg: #f3f4f6; in root.', 'In dark media query: --hero-bg: #333;', 'Use var(--hero-bg) in .hero.'], id: ['Buat --hero-bg: #f3f4f6; di root.', 'Di dark media query: --hero-bg: #333;', 'Gunakan var(--hero-bg) di .hero.'] },
                validation: (code) => /--hero-bg:/i.test(code),
                successMsg: { en: 'Hero adaptive.', id: 'Hero adaptif.' }
            },
            {
                id: 38, chapter: 3, type: 'essay',
                title: { en: '38. Accent Color', id: '38. Warna Aksen' },
                desc: { en: 'Change primary color.', id: 'Ubah warna utama.' },
                guidance: { en: ['Change --primary in :root to #059669 (Emerald).'], id: ['Ubah --primary di :root jadi #059669 (Emerald).'] },
                validation: (code) => /#059669/i.test(code),
                successMsg: { en: 'Rebranded!', id: 'Rebranding!' }
            },
            {
                id: 39, chapter: 3, type: 'essay',
                title: { en: '39. Dark Accent', id: '39. Aksen Gelap' },
                desc: { en: 'Adjust primary for dark mode.', id: 'Sesuaikan primary untuk dark mode.' },
                guidance: { en: ['In dark media query, set --primary: #34d399 (Lighter green).'], id: ['Di dark media query, set --primary: #34d399 (Hijau terang).'] },
                validation: (code) => /#34d399/i.test(code),
                successMsg: { en: 'Contrast fixed.', id: 'Kontras diperbaiki.' }
            },
            {
                id: 40, chapter: 3, type: 'essay',
                title: { en: '40. Chapter 3 Review', id: '40. Review Bab 3' },
                desc: { en: 'System check.', id: 'Cek sistem.' },
                guidance: { en: ['Verify variables work.', 'Save to continue.'], id: ['Verifikasi variabel berjalan.', 'Simpan untuk lanjut.'] },
                validation: (code) => true,
                successMsg: { en: 'Chapter 3 Done!', id: 'Bab 3 Selesai!' }
            },

            // ========================================
            // CHAPTER 4: ADVANCED GRID (41-60)
            // ========================================
            {
                id: 41, chapter: 4, type: 'choice',
                title: { en: '41. Grid Areas', id: '41. Grid Areas' },
                desc: { en: 'Inject named grid layout.', id: 'Suntikkan layout named grid.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Bento Grid', id: 'A. Bento Grid' }, previewCode: 'grid-template-areas: ...', code: '<div class="bento-grid">\n      <div class="box box-1">Main</div>\n      <div class="box box-2">Side</div>\n      <div class="box box-3">Bottom</div>\n    </div>', cssToAdd: '\n    .bento-grid {\n      display: grid;\n      grid-template-columns: 2fr 1fr;\n      grid-template-rows: 200px 150px;\n      grid-template-areas:\n        "header sidebar"\n        "footer footer";\n      gap: 15px;\n      margin-top: 30px;\n    }\n    .box { background: var(--card-bg); border: 1px solid #ccc; padding: 20px; border-radius: var(--radius); }\n    .box-1 { grid-area: header; }\n    .box-2 { grid-area: sidebar; }\n    .box-3 { grid-area: footer; }', correct: true, msg: { en: 'Bento injected.', id: 'Bento ditambahkan.' } }
                ]
            },
            {
                id: 42, chapter: 4, type: 'essay',
                title: { en: '42. Edit Areas', id: '42. Edit Areas' },
                desc: { en: 'Change the layout structure.', id: 'Ubah struktur layout.' },
                guidance: { en: ['Change grid-template-areas to "header header" "sidebar footer".', 'Watch layout shift.'], id: ['Ubah grid-template-areas jadi "header header" "sidebar footer".', 'Lihat layout berubah.'] },
                validation: (code) => /"header\s+header"/i.test(code),
                successMsg: { en: 'Layout shifted.', id: 'Layout berubah.' }
            },
            {
                id: 43, chapter: 4, type: 'choice',
                title: { en: '43. Add Grid Item', id: '43. Tambah Item Grid' },
                desc: { en: 'Inject a 4th box.', id: 'Suntikkan kotak ke-4.' },
                targetMarker: '<div class="box box-3">Bottom</div>',
                options: [
                    { label: { en: 'A. Box 4', id: 'A. Kotak 4' }, previewCode: '<div class="box box-4">', code: '<div class="box box-3">Bottom</div>\n      <div class="box box-4">Extra</div>', cssToAdd: '\n    .box-4 { grid-area: extra; background: #e0f2fe; }', correct: true, msg: { en: 'Box 4 added.', id: 'Kotak 4 ditambah.' } }
                ]
            },
            {
                id: 44, chapter: 4, type: 'essay',
                title: { en: '44. Assign Area', id: '44. Tetapkan Area' },
                desc: { en: 'Place Box 4 in grid.', id: 'Tempatkan Kotak 4 di grid.' },
                guidance: { en: ['Update grid-template-areas to: "header header" "sidebar extra" "footer footer".'], id: ['Update grid-template-areas jadi: "header header" "sidebar extra" "footer footer".'] },
                validation: (code) => /header\s+header/i.test(code) && /sidebar\s+extra/i.test(code),
                successMsg: { en: 'Area assigned.', id: 'Area ditetapkan.' }
            },
            {
                id: 45, chapter: 4, type: 'essay',
                title: { en: '45. Column Widths', id: '45. Lebar Kolom' },
                desc: { en: 'Adjust column ratio.', id: 'Sesuaikan rasio kolom.' },
                guidance: { en: ['Change grid-template-columns to: 1fr 1fr; (Equal width).'], id: ['Ubah grid-template-columns jadi: 1fr 1fr; (Lebar sama).'] },
                validation: (code) => /1fr\s+1fr/i.test(code),
                successMsg: { en: 'Columns equalized.', id: 'Kolom disamakan.' }
            },
            {
                id: 46, chapter: 4, type: 'essay',
                title: { en: '46. Gap Control', id: '46. Kontrol Jarak' },
                desc: { en: 'Tighten the layout.', id: 'Rapatkan layout.' },
                guidance: { en: ['Change gap to 10px.'], id: ['Ubah gap jadi 10px.'] },
                validation: (code) => /gap:\s*10px/i.test(code),
                successMsg: { en: 'Gap tightened.', id: 'Jarak dirapatkan.' }
            },
            {
                id: 47, chapter: 4, type: 'essay',
                title: { en: '47. Row Height', id: '47. Tinggi Baris' },
                desc: { en: 'Make rows taller.', id: 'Buat baris lebih tinggi.' },
                guidance: { en: ['Change grid-template-rows to: 250px 200px auto;'], id: ['Ubah grid-template-rows jadi: 250px 200px auto;'] },
                validation: (code) => /250px/i.test(code),
                successMsg: { en: 'Rows adjusted.', id: 'Baris disesuaikan.' }
            },
            {
                id: 48, chapter: 4, type: 'choice',
                title: { en: '48. Nested Grid', id: '48. Grid Bersarang' },
                desc: { en: 'Turn Box 1 into a grid.', id: 'Ubah Box 1 jadi grid.' },
                targetMarker: '<div class="box box-1">Main</div>',
                options: [
                    { label: { en: 'A. Nested Structure', id: 'A. Struktur Bersarang' }, previewCode: 'display: grid inside box', code: '<div class="box box-1 nested-parent">\n        <div>Item A</div>\n        <div>Item B</div>\n      </div>', cssToAdd: '\n    .nested-parent { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }', correct: true, msg: { en: 'Nesting complete.', id: 'Nesting selesai.' } }
                ]
            },
            {
                id: 49, chapter: 4, type: 'essay',
                title: { en: '49. Nested Style', id: '49. Gaya Bersarang' },
                desc: { en: 'Style inner items.', id: 'Gaya item dalam.' },
                guidance: { en: ['Add background color to inner divs of .nested-parent (use simple CSS selector like .nested-parent div { bg: #eee }).'], id: ['Beri background div dalam .nested-parent (pakai selector .nested-parent div { bg: #eee }).'] },
                validation: (code) => /\.nested-parent\s+div/i.test(code),
                successMsg: { en: 'Inner items styled.', id: 'Item dalam digayakan.' }
            },
            {
                id: 50, chapter: 4, type: 'essay',
                title: { en: '50. Alignment', id: '50. Perataan' },
                desc: { en: 'Center content in grid items.', id: 'Tengahkan konten item grid.' },
                guidance: { en: ['Add align-items: center; justify-items: center; to .bento-grid.'], id: ['Tambah align-items: center; justify-items: center; ke .bento-grid.'] },
                validation: (code) => /align-items:\s*center/i.test(code),
                successMsg: { en: 'Centered.', id: 'Ditengahkan.' }
            },
            {
                id: 51, chapter: 4, type: 'essay',
                title: { en: '51. Stretch', id: '51. Stretch' },
                desc: { en: 'Make items fill space.', id: 'Buat item isi ruang.' },
                guidance: { en: ['Remove align-items/justify-items or set to "stretch".'], id: ['Hapus align-items/justify-items atau set ke "stretch".'] },
                validation: (code) => !/align-items:\s*center/i.test(code) || /stretch/i.test(code),
                successMsg: { en: 'Stretched.', id: 'Di-stretch.' }
            },
            {
                id: 52, chapter: 4, type: 'choice',
                title: { en: '52. Auto-Fill', id: '52. Auto-Fill' },
                desc: { en: 'Inject responsive columns.', id: 'Suntik kolom responsif.' },
                targetMarker: 'grid-template-columns: 1fr 1fr;',
                options: [
                    { label: { en: 'A. Repeat Auto-Fill', id: 'A. Repeat Auto-Fill' }, previewCode: 'repeat(auto-fill, ...)', code: 'grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));', cssToAdd: '', correct: true, msg: { en: 'Auto-fill active.', id: 'Auto-fill aktif.' } }
                ]
            },
            {
                id: 53, chapter: 4, type: 'essay',
                title: { en: '53. MinMax Tweak', id: '53. Tweak MinMax' },
                desc: { en: 'Adjust minimum width.', id: 'Sesuaikan lebar minimum.' },
                guidance: { en: ['Change minmax(100px) to minmax(150px).'], id: ['Ubah minmax(100px) jadi minmax(150px).'] },
                validation: (code) => /150px/i.test(code),
                successMsg: { en: 'Minmax adjusted.', id: 'Minmax disesuaikan.' }
            },
            {
                id: 54, chapter: 4, type: 'essay',
                title: { en: '54. Implicit Rows', id: '54. Baris Implisit' },
                desc: { en: 'Control auto-created rows.', id: 'Kontrol baris otomatis.' },
                guidance: { en: ['Add grid-auto-rows: 150px; to .bento-grid.'], id: ['Tambah grid-auto-rows: 150px; ke .bento-grid.'] },
                validation: (code) => /grid-auto-rows:/i.test(code),
                successMsg: { en: 'Auto rows set.', id: 'Baris otomatis diatur.' }
            },
            {
                id: 55, chapter: 4, type: 'essay',
                title: { en: '55. Order Property', id: '55. Properti Order' },
                desc: { en: 'Change visual order.', id: 'Ubah urutan visual.' },
                guidance: { en: ['Add order: -1; to .box-4.', 'It moves to first position.'], id: ['Tambah order: -1; ke .box-4.', 'Pindah ke posisi pertama.'] },
                validation: (code) => /order:\s*-1/i.test(code),
                successMsg: { en: 'Reordered.', id: 'Diurutkan ulang.' }
            },
            {
                id: 56, chapter: 4, type: 'essay',
                title: { en: '56. Z-Index Grid', id: '56. Z-Index Grid' },
                desc: { en: 'Overlap items.', id: 'Tumpuk item.' },
                guidance: { en: ['Set .box-1 margin-right: -20px; z-index: 10;', 'Overlaps next item.'], id: ['Set .box-1 margin-right: -20px; z-index: 10;', 'Menumpuk item berikutnya.'] },
                validation: (code) => /z-index:/i.test(code),
                successMsg: { en: 'Overlapped.', id: 'Ditumpuk.' }
            },
            {
                id: 57, chapter: 4, type: 'choice',
                title: { en: '57. Grid Line Names', id: '57. Nama Garis Grid' },
                desc: { en: 'Inject named lines definition.', id: 'Suntik definisi nama garis.' },
                targetMarker: 'grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));',
                options: [
                    { label: { en: 'A. Line Names', id: 'A. Nama Garis' }, previewCode: '[start] 1fr [end]', code: 'grid-template-columns: [main-start] 1fr [center] 1fr [main-end];', cssToAdd: '', correct: true, msg: { en: 'Lines named.', id: 'Garis dinamai.' } }
                ]
            },
            {
                id: 58, chapter: 4, type: 'essay',
                title: { en: '58. Use Lines', id: '58. Pakai Garis' },
                desc: { en: 'Position using names.', id: 'Posisikan pakai nama.' },
                guidance: { en: ['Set .box-1 grid-column: main-start / main-end;'], id: ['Set .box-1 grid-column: main-start / main-end;'] },
                validation: (code) => /main-start/i.test(code),
                successMsg: { en: 'Positioned by name.', id: 'Diposisikan via nama.' }
            },
            {
                id: 59, chapter: 4, type: 'essay',
                title: { en: '59. Dense Flow', id: '59. Aliran Dense' },
                desc: { en: 'Pack items tightly.', id: 'Padatkan item.' },
                guidance: { en: ['Add grid-auto-flow: dense; to container.'], id: ['Tambah grid-auto-flow: dense; ke container.'] },
                validation: (code) => /dense/i.test(code),
                successMsg: { en: 'Dense flow active.', id: 'Dense flow aktif.' }
            },
            {
                id: 60, chapter: 4, type: 'essay',
                title: { en: '60. Clean Up', id: '60. Bersih-bersih' },
                desc: { en: 'Reset grid for Chapter 5.', id: 'Reset grid untuk Bab 5.' },
                guidance: { en: ['Set grid-template-columns: 1fr 1fr;', 'Remove complex areas/ordering.'], id: ['Set grid-template-columns: 1fr 1fr;', 'Hapus area/ordering kompleks.'] },
                validation: (code) => /1fr\s+1fr/i.test(code),
                successMsg: { en: 'Grid Reset.', id: 'Grid Direset.' }
            },

            // ========================================
            // CHAPTER 5: RESPONSIVE (61-80)
            // ========================================
            {
                id: 61, chapter: 5, type: 'choice',
                title: { en: '61. Mobile Query', id: '61. Mobile Query' },
                desc: { en: 'Inject Media Query block.', id: 'Suntik blok Media Query.' },
                targetMarker: '/* === AREA CSS KAMU ADA DI BAWAH === */',
                options: [
                    { label: { en: 'A. Max-Width 768px', id: 'A. Max-Width 768px' }, previewCode: '@media (max-width: 768px)', code: '\n    @media (max-width: 768px) {\n      /* MOBILE STYLES */\n    }', cssToAdd: '', correct: true, msg: { en: 'Query added.', id: 'Query ditambahkan.' } }
                ]
            },
            {
                id: 62, chapter: 5, type: 'essay',
                title: { en: '62. Stack Grid', id: '62. Tumpuk Grid' },
                desc: { en: 'Make grid 1 column on mobile.', id: 'Buat grid 1 kolom di mobile.' },
                guidance: { en: ['Inside @media, add: .bento-grid { grid-template-columns: 1fr; }'], id: ['Di dalam @media, tambah: .bento-grid { grid-template-columns: 1fr; }'] },
                validation: (code) => /@media.*grid-template-columns:\s*1fr/is.test(code),
                successMsg: { en: 'Stacked!', id: 'Ditumpuk!' }
            },
            {
                id: 63, chapter: 5, type: 'essay',
                title: { en: '63. Stack Nav', id: '63. Tumpuk Nav' },
                desc: { en: 'Make menu vertical on mobile.', id: 'Buat menu vertikal di mobile.' },
                guidance: { en: ['Inside @media, add: .menu-box { flex-direction: column; }'], id: ['Di dalam @media, tambah: .menu-box { flex-direction: column; }'] },
                validation: (code) => /flex-direction:\s*column/i.test(code),
                successMsg: { en: 'Nav stacked.', id: 'Nav ditumpuk.' }
            },
            {
                id: 64, chapter: 5, type: 'essay',
                title: { en: '64. Mobile Padding', id: '64. Padding Mobile' },
                desc: { en: 'Reduce container padding.', id: 'Kurangi padding container.' },
                guidance: { en: ['Inside @media, add: .main-container { padding: 10px; }'], id: ['Di dalam @media, tambah: .main-container { padding: 10px; }'] },
                validation: (code) => /@media.*padding:\s*10px/is.test(code),
                successMsg: { en: 'Padding reduced.', id: 'Padding dikurangi.' }
            },
            {
                id: 65, chapter: 5, type: 'essay',
                title: { en: '65. Mobile Hero', id: '65. Hero Mobile' },
                desc: { en: 'Smaller hero padding.', id: 'Padding hero kecil.' },
                guidance: { en: ['Inside @media, .hero { padding: 30px 10px; }'], id: ['Di dalam @media, .hero { padding: 30px 10px; }'] },
                validation: (code) => /@media.*hero/is.test(code),
                successMsg: { en: 'Hero resized.', id: 'Hero diresize.' }
            },
            {
                id: 66, chapter: 5, type: 'essay',
                title: { en: '66. Mobile Font', id: '66. Font Mobile' },
                desc: { en: 'Smaller headings.', id: 'Judul lebih kecil.' },
                guidance: { en: ['Inside @media, h1 { font-size: 1.5em; }'], id: ['Di dalam @media, h1 { font-size: 1.5em; }'] },
                validation: (code) => /@media.*font-size/is.test(code),
                successMsg: { en: 'Font resized.', id: 'Font diresize.' }
            },
            {
                id: 67, chapter: 5, type: 'essay',
                title: { en: '67. Hide Elements', id: '67. Sembunyi Elemen' },
                desc: { en: 'Hide box 4 on mobile.', id: 'Sembunyikan box 4 di mobile.' },
                guidance: { en: ['Inside @media, .box-4 { display: none; }'], id: ['Di dalam @media, .box-4 { display: none; }'] },
                validation: (code) => /@media.*display:\s*none/is.test(code),
                successMsg: { en: 'Hidden.', id: 'Disembunyikan.' }
            },
            {
                id: 68, chapter: 5, type: 'choice',
                title: { en: '68. Tablet Query', id: '68. Tablet Query' },
                desc: { en: 'Inject Tablet Breakpoint.', id: 'Suntik Breakpoint Tablet.' },
                targetMarker: '/* === AREA CSS KAMU ADA DI BAWAH === */',
                options: [
                    { label: { en: 'A. Min-Width 769px', id: 'A. Min-Width 769px' }, previewCode: '@media (min-width: 769px)', code: '\n    @media (min-width: 769px) and (max-width: 1024px) {\n      /* TABLET */\n    }', cssToAdd: '', correct: true, msg: { en: 'Tablet query added.', id: 'Query tablet ditambah.' } }
                ]
            },
            {
                id: 69, chapter: 5, type: 'essay',
                title: { en: '69. Tablet Grid', id: '69. Grid Tablet' },
                desc: { en: '2 Columns on tablet.', id: '2 Kolom di tablet.' },
                guidance: { en: ['In tablet query, .bento-grid { grid-template-columns: 1fr 1fr; }'], id: ['Di query tablet, .bento-grid { grid-template-columns: 1fr 1fr; }'] },
                validation: (code) => /@media.*min-width.*grid-template/is.test(code),
                successMsg: { en: 'Tablet grid set.', id: 'Grid tablet diatur.' }
            },
            {
                id: 70, chapter: 5, type: 'essay',
                title: { en: '70. Touch Target', id: '70. Target Sentuh' },
                desc: { en: 'Bigger buttons on mobile.', id: 'Tombol besar di mobile.' },
                guidance: { en: ['In mobile query, .btn { padding: 15px; }'], id: ['Di query mobile, .btn { padding: 15px; }'] },
                validation: (code) => /@media.*btn.*padding/is.test(code),
                successMsg: { en: 'Touch ready.', id: 'Siap sentuh.' }
            },
            {
                id: 71, chapter: 5, type: 'essay',
                title: { en: '71. Flex Wrap', id: '71. Flex Wrap' },
                desc: { en: 'Allow menu to wrap.', id: 'Izinkan menu membungkus.' },
                guidance: { en: ['Add flex-wrap: wrap; to .menu-box (global).'], id: ['Tambah flex-wrap: wrap; ke .menu-box (global).'] },
                validation: (code) => /flex-wrap:\s*wrap/i.test(code),
                successMsg: { en: 'Wrapped.', id: 'Dibungkus.' }
            },
            {
                id: 72, chapter: 5, type: 'essay',
                title: { en: '72. Viewport Height', id: '72. Tinggi Viewport' },
                desc: { en: 'Hero takes screen height.', id: 'Hero ambil tinggi layar.' },
                guidance: { en: ['Add min-height: 50vh; to .hero.'], id: ['Tambah min-height: 50vh; ke .hero.'] },
                validation: (code) => /50vh/i.test(code),
                successMsg: { en: 'Viewport unit used.', id: 'Unit viewport dipakai.' }
            },
            {
                id: 73, chapter: 5, type: 'choice',
                title: { en: '73. Print Style', id: '73. Gaya Print' },
                desc: { en: 'Inject Print Query.', id: 'Suntik Query Print.' },
                targetMarker: '/* === AREA CSS KAMU ADA DI BAWAH === */',
                options: [
                    { label: { en: 'A. Media Print', id: 'A. Media Print' }, previewCode: '@media print', code: '\n    @media print {\n      .hero, .site-footer { display: none; }\n      body { color: black; background: white; }\n    }', cssToAdd: '', correct: true, msg: { en: 'Print style added.', id: 'Style print ditambah.' } }
                ]
            },
            {
                id: 74, chapter: 5, type: 'essay',
                title: { en: '74. Print Border', id: '74. Border Print' },
                desc: { en: 'Remove borders on print.', id: 'Hapus border saat print.' },
                guidance: { en: ['In print query, add * { border: none !important; }'], id: ['Di query print, tambah * { border: none !important; }'] },
                validation: (code) => /print[\s\S]*border:\s*none/i.test(code),
                successMsg: { en: 'Clean print.', id: 'Print bersih.' }
            },
            {
                id: 75, chapter: 5, type: 'choice',
                title: { en: '75. Image Layout', id: '75. Layout Gambar' },
                desc: { en: 'Inject an image for testing.', id: 'Suntik gambar untuk tes.' },
                targetMarker: '',
                options: [
                    { label: { en: 'A. Test Image', id: 'A. Gambar Tes' }, previewCode: '<img src="...">', code: '<img src="https://via.placeholder.com/800x400" class="resp-img" alt="Test">', cssToAdd: '', correct: true, msg: { en: 'Image added.', id: 'Gambar ditambah.' } }
                ]
            },
            {
                id: 76, chapter: 5, type: 'essay',
                title: { en: '76. Fluid Image', id: '76. Gambar Cair' },
                desc: { en: 'Make image responsive.', id: 'Buat gambar responsif.' },
                guidance: { en: ['Add .resp-img { max-width: 100%; height: auto; }'], id: ['Tambah .resp-img { max-width: 100%; height: auto; }'] },
                validation: (code) => /max-width:\s*100%/i.test(code),
                successMsg: { en: 'Fluid image.', id: 'Gambar cair.' }
            },
            {
                id: 77, chapter: 5, type: 'essay',
                title: { en: '77. Round Image', id: '77. Gambar Bulat' },
                desc: { en: 'Round the image corners.', id: 'Bulatkan sudut gambar.' },
                guidance: { en: ['Add border-radius: var(--radius); to .resp-img.'], id: ['Tambah border-radius: var(--radius); ke .resp-img.'] },
                validation: (code) => /\.resp-img[\s\S]*radius/i.test(code),
                successMsg: { en: 'Rounded.', id: 'Bulat.' }
            },
            {
                id: 78, chapter: 5, type: 'essay',
                title: { en: '78. Mobile Gap', id: '78. Gap Mobile' },
                desc: { en: 'Smaller gaps on mobile.', id: 'Gap kecil di mobile.' },
                guidance: { en: ['In mobile query, .bento-grid { gap: 10px; }'], id: ['Di query mobile, .bento-grid { gap: 10px; }'] },
                validation: (code) => /@media.*gap:\s*10px/is.test(code),
                successMsg: { en: 'Gap adjusted.', id: 'Gap disesuaikan.' }
            },
            {
                id: 79, chapter: 5, type: 'essay',
                title: { en: '79. Container Query Prep', id: '79. Prep Container Query' },
                desc: { en: 'Define container type.', id: 'Definisikan tipe container.' },
                guidance: { en: ['Add container-type: inline-size; to .main-container.'], id: ['Tambah container-type: inline-size; ke .main-container.'] },
                validation: (code) => /container-type/i.test(code),
                successMsg: { en: 'Container defined.', id: 'Container didefinisikan.' }
            },
            {
                id: 80, chapter: 5, type: 'essay',
                title: { en: '80. Review Responsive', id: '80. Review Responsif' },
                desc: { en: 'Check resizing.', id: 'Cek resize.' },
                guidance: { en: ['Resize browser to check mobile view.', 'Save to finish.'], id: ['Resize browser untuk cek tampilan mobile.', 'Simpan untuk selesai.'] },
                validation: (code) => true,
                successMsg: { en: 'Chapter 5 Done!', id: 'Bab 5 Selesai!' }
            },

            // ========================================
            // CHAPTER 6: ANIMATION (81-90)
            // ========================================
            {
                id: 81, chapter: 6, type: 'choice',
                title: { en: '81. Transitions', id: '81. Transisi' },
                desc: { en: 'Inject transition property.', id: 'Suntik properti transition.' },
                targetMarker: '.btn {',
                options: [
                    { label: { en: 'A. Transition All', id: 'A. Transition All' }, previewCode: 'transition: all 0.3s', code: '.btn {\n      transition: all 0.3s ease;', cssToAdd: '', correct: true, msg: { en: 'Transition added.', id: 'Transisi ditambah.' } }
                ]
            },
            {
                id: 82, chapter: 6, type: 'essay',
                title: { en: '82. Button Transform', id: '82. Transform Tombol' },
                desc: { en: 'Move button on hover.', id: 'Gerakkan tombol saat hover.' },
                guidance: { en: ['In .btn:hover, add transform: translateY(-2px);'], id: ['Di .btn:hover, tambah transform: translateY(-2px);'] },
                validation: (code) => /translateY/i.test(code),
                successMsg: { en: 'Button moves.', id: 'Tombol bergerak.' }
            },
            {
                id: 83, chapter: 6, type: 'choice',
                title: { en: '83. Keyframes', id: '83. Keyframes' },
                desc: { en: 'Inject FadeIn animation.', id: 'Suntik animasi FadeIn.' },
                targetMarker: '/* === AREA CSS KAMU ADA DI BAWAH === */',
                options: [
                    { label: { en: 'A. FadeIn Block', id: 'A. Blok FadeIn' }, previewCode: '@keyframes fadeIn', code: '\n    @keyframes fadeIn {\n      from { opacity: 0; transform: translateY(20px); }\n      to { opacity: 1; transform: translateY(0); }\n    }', cssToAdd: '', correct: true, msg: { en: 'Keyframes added.', id: 'Keyframes ditambah.' } }
                ]
            },
            {
                id: 84, chapter: 6, type: 'essay',
                title: { en: '84. Apply Animation', id: '84. Terapkan Animasi' },
                desc: { en: 'Animate the Hero.', id: 'Animasi Hero.' },
                guidance: { en: ['Add animation: fadeIn 1s ease-out; to .hero.'], id: ['Tambah animation: fadeIn 1s ease-out; ke .hero.'] },
                validation: (code) => /animation:\s*fadeIn/i.test(code),
                successMsg: { en: 'Hero fades in.', id: 'Hero fade in.' }
            },
            {
                id: 85, chapter: 6, type: 'essay',
                title: { en: '85. Card Hover', id: '85. Hover Kartu' },
                desc: { en: 'Cards lift up.', id: 'Kartu terangkat.' },
                guidance: { en: ['Add transition: transform 0.2s; to .card.', 'Add .card:hover { transform: translateY(-5px); }'], id: ['Tambah transition: transform 0.2s; ke .card.', 'Tambah .card:hover { transform: translateY(-5px); }'] },
                validation: (code) => /\.card:hover/i.test(code) && /translateY/i.test(code),
                successMsg: { en: 'Cards lift.', id: 'Kartu terangkat.' }
            },
            {
                id: 86, chapter: 6, type: 'choice',
                title: { en: '86. Pulse Animation', id: '86. Animasi Pulse' },
                desc: { en: 'Inject Pulse Keyframes.', id: 'Suntik Keyframes Pulse.' },
                targetMarker: '/* === AREA CSS KAMU ADA DI BAWAH === */',
                options: [
                    { label: { en: 'A. Pulse Block', id: 'A. Blok Pulse' }, previewCode: '@keyframes pulse', code: '\n    @keyframes pulse {\n      0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.7); }\n      70% { box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); }\n      100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }\n    }', cssToAdd: '', correct: true, msg: { en: 'Pulse added.', id: 'Pulse ditambah.' } }
                ]
            },
            {
                id: 87, chapter: 6, type: 'essay',
                title: { en: '87. Apply Pulse', id: '87. Terapkan Pulse' },
                desc: { en: 'Pulse the button.', id: 'Pulse tombolnya.' },
                guidance: { en: ['Add animation: pulse 2s infinite; to .btn:hover.'], id: ['Tambah animation: pulse 2s infinite; ke .btn:hover.'] },
                validation: (code) => /pulse\s+2s/i.test(code),
                successMsg: { en: 'Button pulsing.', id: 'Tombol berdenyut.' }
            },
            {
                id: 88, chapter: 6, type: 'essay',
                title: { en: '88. Input Focus Trans', id: '88. Transisi Fokus' },
                desc: { en: 'Smooth input focus.', id: 'Fokus input halus.' },
                guidance: { en: ['Add transition: border-color 0.3s; to .inp.'], id: ['Tambah transition: border-color 0.3s; ke .inp.'] },
                validation: (code) => /\.inp[\s\S]*transition/i.test(code),
                successMsg: { en: 'Smooth focus.', id: 'Fokus halus.' }
            },
            {
                id: 89, chapter: 6, type: 'essay',
                title: { en: '89. Stagger Delay', id: '89. Delay Bertahap' },
                desc: { en: 'Animate cards sequentially.', id: 'Animasi kartu berurutan.' },
                guidance: { en: ['Add .card { animation: fadeIn 0.8s backwards; }', 'Add .box-1 { animation-delay: 0.2s; }'], id: ['Tambah .card { animation: fadeIn 0.8s backwards; }', 'Tambah .box-1 { animation-delay: 0.2s; }'] },
                validation: (code) => /animation-delay:/i.test(code),
                successMsg: { en: 'Staggered.', id: 'Bertahap.' }
            },
            {
                id: 90, chapter: 6, type: 'playground',
                title: { en: '90. FINAL PLAYGROUND', id: '90. PLAYGROUND AKHIR' },
                desc: { en: 'You are a CSS Master!', id: 'Kamu CSS Master!' },
                guidance: { 
                    en: [
                        ' All 90 levels completed!',
                        ' You built: Layouts, Forms, Themes, Responsive, Animations.',
                        ' Make any final changes you want.',
                        ' Export your code to keep it forever.'
                    ], 
                    id: [
                        ' 90 Level selesai!',
                        ' Kamu membuat: Layout, Form, Tema, Responsif, Animasi.',
                        ' Lakukan perubahan akhir sesukamu.',
                        ' Export kodemu untuk disimpan selamanya.'
                    ] 
                }
            }
        ];

        // --- INITIAL TEMPLATE ---
        const BASE_TEMPLATE = `<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: sans-serif; padding: 0; margin: 0; background-color: #ffffff; color: #333; }
    
    /* === AREA CSS KAMU ADA DI BAWAH === */
  </style>
</head>
<body>

  </body>
</html>`;

        function App() {
            const [lang, setLang] = useState(() => localStorage.getItem('np_mod_lang') || 'id');
            const [levelIdx, setLevelIdx] = useState(0);
            const [code, setCode] = useState(BASE_TEMPLATE);
            const [feedback, setFeedback] = useState(null);
            
            const level = LEVELS[levelIdx];

            useEffect(() => {
                localStorage.setItem('np_mod_lang', lang);
            }, [lang]);

            const iframeRef = useRef(null);
            useEffect(() => {
                if (iframeRef.current) iframeRef.current.srcdoc = code;
            }, [code]);

            const handleChoice = (opt) => {
                if (!opt.correct) {
                    setFeedback({ type: 'error', msg: opt.msg[lang] });
                    return;
                }
                let newCode = code.replace(level.targetMarker, opt.code);
                if (opt.cssToAdd) {
                    const styleEnd = newCode.indexOf('</style>');
                    if (styleEnd !== -1) {
                        newCode = newCode.slice(0, styleEnd) + opt.cssToAdd + newCode.slice(styleEnd);
                    }
                }
                setCode(newCode);
                setFeedback({ type: 'success', msg: opt.msg[lang] });
            };

            const handleEssayCheck = () => {
                // If it's the final playground, just save/succeed
                if (level.type === 'playground') {
                     setFeedback({ type: 'success', msg: lang === 'id' ? 'Kode Disimpan!' : 'Code Saved!' });
                     return;
                }

                if (level.validation && !level.validation(code)) {
                    setFeedback({ type: 'error', msg: lang === 'id' ? 'Cek instruksi. Nilai belum sesuai.' : 'Check instructions. Value not matched.' });
                } else {
                    setFeedback({ type: 'success', msg: level.successMsg ? level.successMsg[lang] : 'Saved!' });
                }
            };

            const nextLevel = () => {
                setFeedback(null);
                if (levelIdx < LEVELS.length - 1) setLevelIdx(prev => prev + 1);
            };

            const exportHTML = () => {
                const blob = new Blob([code], {type: 'text/html'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'modern-website.html';
                a.click();
            };

            const currentChapter = level.chapter || 1;
            const chapterLevels = LEVELS.filter(l => l.chapter === currentChapter);
            const chapterProgress = chapterLevels.findIndex(l => l.id === level.id) + 1;

            return (
                <div className="flex flex-col h-full font-mono text-sm">
                    {/* HEADER */}
                    <header className="bg-neutral-800 border-b border-neutral-700 p-3 flex justify-between items-center text-white shrink-0">
                        <div className="flex items-center gap-2">
                            <TerminalIcon className="text-green-500" />
                            <span className="font-bold tracking-wider text-green-500 hidden sm:inline">NP_MODERNIZER.EXE</span>
                            <span className="font-bold tracking-wider text-green-500 sm:hidden">NP_MOD</span>
                        </div>
                        <div className="flex gap-3 items-center">
                            <div className="text-xs bg-neutral-700 px-2 py-1 rounded text-neutral-300">
                                Ch{currentChapter}  {chapterProgress}/{chapterLevels.length}  {levelIdx + 1}/90
                            </div>
                            <button onClick={() => setLang(l => l === 'en' ? 'id' : 'en')} className="flex items-center gap-1 bg-neutral-700 hover:bg-neutral-600 px-2 py-1 rounded text-xs transition border border-neutral-600">
                                <GlobeIcon /> {lang.toUpperCase()}
                            </button>
                            <button onClick={exportHTML} className="bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded text-xs font-bold flex items-center gap-1 transition shadow-lg shadow-blue-900/20">
                                <SaveIcon /> <span className="hidden sm:inline">EXPORT</span>
                            </button>
                        </div>
                    </header>

                    <div className="flex-1 flex flex-col md:flex-row overflow-hidden">
                        {/* LEFT: INTERACTIVE TERMINAL */}
                        <div className="w-full md:w-1/2 flex flex-col border-r border-neutral-700 bg-black h-1/2 md:h-full">
                            <div className="p-4 bg-neutral-900 border-b border-neutral-700 shadow-md z-10">
                                <h2 className="text-yellow-400 font-bold mb-1 text-base flex items-center gap-2 crt-text">
                                    <span className="text-green-500">&gt;</span> {level.title[lang]}
                                </h2>
                                <p className="text-neutral-300 text-sm mb-2 leading-relaxed">{level.desc[lang]}</p>
                                
                                {(level.type === 'essay' || level.type === 'playground') && (
                                    <div className="mt-2 bg-neutral-800 p-3 rounded border border-neutral-600 relative overflow-hidden">
                                        <div className="absolute top-0 left-0 w-1 h-full bg-green-500"></div>
                                        <div className="text-[10px] text-green-400 uppercase font-bold mb-1 tracking-wider flex items-center gap-2">
                                            <span className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                                            {lang === 'id' ? 'MISI EDIT (CARI DI KODE):' : 'EDIT MISSION (FIND IN CODE):'}
                                        </div>
                                        <ul className="list-disc list-inside text-xs text-neutral-300 space-y-1 ml-1">
                                            {level.guidance[lang].map((g, i) => <li key={i}>{g}</li>)}
                                        </ul>
                                    </div>
                                )}
                            </div>

                            <div className="flex-1 relative group">
                                <textarea 
                                    className="w-full h-full bg-black text-green-500 p-4 resize-none focus:outline-none leading-relaxed selection:bg-green-900 selection:text-white font-mono text-sm"
                                    spellCheck="false"
                                    value={code}
                                    onChange={(e) => {
                                        setCode(e.target.value);
                                        if(feedback?.type === 'error') setFeedback(null);
                                    }}
                                />
                            </div>

                            <div className="p-4 bg-neutral-900 border-t border-neutral-700 min-h-[120px] flex flex-col justify-center shrink-0">
                                {level.type === 'choice' && !feedback && (
                                    <div className="space-y-2 overflow-y-auto max-h-[160px] pr-1">
                                        {level.options.map((opt, i) => (
                                            <button key={i} onClick={() => handleChoice(opt)} 
                                                className="w-full text-left px-3 py-2 bg-neutral-800 border border-neutral-600 hover:border-green-500 hover:bg-neutral-700 rounded transition group flex items-start gap-3">
                                                <div className="text-green-400 font-bold text-lg pt-0.5">{String.fromCharCode(65 + i)}.</div>
                                                <div className="flex-1">
                                                    <div className="text-neutral-200 font-bold text-sm mb-1">{opt.label[lang].substring(3)}</div>
                                                    {opt.previewCode && (
                                                        <div className="text-[10px] font-mono text-green-300/80 bg-black/40 p-1.5 rounded border border-white/5 truncate">
                                                            {opt.previewCode}
                                                        </div>
                                                    )}
                                                </div>
                                            </button>
                                        ))}
                                    </div>
                                )}

                                {(level.type === 'essay' || level.type === 'playground') && !feedback && (
                                    <button onClick={handleEssayCheck} className="w-full py-3 bg-green-700 hover:bg-green-600 text-white font-bold rounded flex justify-center items-center gap-2 transition hover:shadow-lg hover:shadow-green-900/20">
                                        <PlayIcon /> {lang === 'id' ? 'SIMPAN PERUBAHAN' : 'SAVE CHANGES'}
                                    </button>
                                )}

                                {feedback && (
                                    <div className={`p-3 rounded border flex items-center gap-3 animate-in fade-in slide-in-from-bottom-2 ${feedback.type === 'success' ? 'bg-green-900/30 border-green-600' : 'bg-red-900/30 border-red-600'}`}>
                                        {feedback.type === 'success' ? <CheckCircleIcon className="text-green-400 shrink-0" /> : <TerminalIcon className="text-red-400 shrink-0" />}
                                        <div className="flex-1 text-sm">
                                            <div className={`font-bold ${feedback.type === 'success' ? 'text-green-400' : 'text-red-400'}`}>
                                                {feedback.type === 'success' ? (lang === 'id' ? 'SUKSES' : 'SUCCESS') : 'ERROR'}
                                            </div>
                                            <div className="text-neutral-300 text-xs mt-0.5">{feedback.msg}</div>
                                        </div>
                                        {feedback.type === 'success' && levelIdx < LEVELS.length - 1 && (
                                            <button onClick={nextLevel} className="bg-green-600 hover:bg-green-500 text-white px-4 py-1.5 rounded text-xs font-bold animate-pulse whitespace-nowrap">
                                                NEXT &gt;&gt;
                                            </button>
                                        )}
                                        {feedback.type === 'error' && (
                                            <button onClick={() => setFeedback(null)} className="text-neutral-400 hover:text-white underline text-xs whitespace-nowrap">Reset</button>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* RIGHT: LIVE PREVIEW */}
                        <div className="w-full md:w-1/2 bg-white flex flex-col h-1/2 md:h-full border-t md:border-t-0 md:border-l border-neutral-700">
                            <div className="h-8 bg-neutral-200 border-b border-neutral-300 flex items-center px-2 gap-2 shrink-0">
                                <div className="flex gap-1.5">
                                    <div className="w-3 h-3 rounded-full bg-red-400"></div>
                                    <div className="w-3 h-3 rounded-full bg-yellow-400"></div>
                                    <div className="w-3 h-3 rounded-full bg-green-400"></div>
                                </div>
                                <div className="text-[10px] text-neutral-500 font-sans truncate px-2 bg-white/50 rounded flex-1">localhost:3000/my-site</div>
                            </div>
                            <div className="flex-1 bg-checkered relative">
                                <iframe ref={iframeRef} title="preview" className="w-full h-full border-none" sandbox="allow-scripts" />
                                <div className="absolute bottom-2 right-2 bg-black/10 text-black/40 px-2 py-1 text-[10px] font-bold rounded pointer-events-none">LIVE PREVIEW</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
